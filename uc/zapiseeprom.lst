   1               		.file	"zapiseeprom.c"
   2               	__SP_H__ = 0x3e
   3               	__SP_L__ = 0x3d
   4               	__SREG__ = 0x3f
   5               	__RAMPZ__ = 0x3b
   6               	__tmp_reg__ = 0
   7               	__zero_reg__ = 1
   8               		.text
   9               	.Ltext0:
  10               		.cfi_sections	.debug_frame
  12               	zapisz_znaki_w_eeprom_bez_kopiowania.part.0:
  13               	.LFB9:
  14               		.file 1 "zapiseeprom.c"
   1:zapiseeprom.c **** 
   2:zapiseeprom.c **** #include "zapiseeprom.h"
   3:zapiseeprom.c **** #include <avr/io.h>
   4:zapiseeprom.c **** #include <avr/interrupt.h>
   5:zapiseeprom.c **** #include <string.h>
   6:zapiseeprom.c **** #include <ctype.h>
   7:zapiseeprom.c **** 
   8:zapiseeprom.c **** uchar bufor_eeprom[MAX_BUFOR_EEPROM];
   9:zapiseeprom.c **** uchar liczba_znakow_do_zapisu = 0;
  10:zapiseeprom.c **** uchar nr_zapisanego_znaku = 0;
  11:zapiseeprom.c **** uint pozycja_w_eeprom;
  12:zapiseeprom.c **** 
  13:zapiseeprom.c **** uchar bufor_pomoc_liczba_znakow_do_zapisu;
  14:zapiseeprom.c **** uint bufor_pomoc_adres_eeprom;
  15:zapiseeprom.c **** 
  16:zapiseeprom.c **** uchar czy_zajety_bufor_eeprom;
  17:zapiseeprom.c **** 
  18:zapiseeprom.c **** #define EEPROM_WRITE_ATMEGA8(uiAddress, ucData)	\
  19:zapiseeprom.c **** {																								\
  20:zapiseeprom.c **** 	const uint p = uiAddress;											\
  21:zapiseeprom.c **** 	EEARH = HIGH(p);															\
  22:zapiseeprom.c **** 	EEARL = LOW(p);																\
  23:zapiseeprom.c **** 	EECR |= BIT(EERE);														\
  24:zapiseeprom.c **** 	if ( EEDR != (ucData) )													\
  25:zapiseeprom.c **** 	{																							\
  26:zapiseeprom.c **** 		EEDR = (ucData);														\
  27:zapiseeprom.c **** 		cli();																			\
  28:zapiseeprom.c **** 		EECR |= BIT(EEMPE);													\
  29:zapiseeprom.c **** 		EECR |= BIT(EEPE);													\
  30:zapiseeprom.c **** 		sei();																			\
  31:zapiseeprom.c **** 	}																							\
  32:zapiseeprom.c **** }
  33:zapiseeprom.c **** 
  34:zapiseeprom.c **** #define EEPROM_READ_ATMEGA8(uiAddress, data)				\
  35:zapiseeprom.c **** {																										\
  36:zapiseeprom.c **** 	const uint p = uiAddress;													\
  37:zapiseeprom.c **** 	EEARH = HIGH(p);																	\
  38:zapiseeprom.c **** 	EEARL = LOW(p);																		\
  39:zapiseeprom.c **** 	EECR |= BIT(EERE);																\
  40:zapiseeprom.c **** 	(data) = EEDR;																		\
  41:zapiseeprom.c **** }
  42:zapiseeprom.c **** 
  43:zapiseeprom.c **** 	// uwaga, w-¦cza przerwania sei()
  44:zapiseeprom.c **** void zapisz_bajt_w_EEPROM(void)
  45:zapiseeprom.c **** {
  46:zapiseeprom.c **** 	if ( !eeprom_is_ready() 
  47:zapiseeprom.c **** 		|| (bufor_pomoc_liczba_znakow_do_zapisu == 0 && liczba_znakow_do_zapisu == 0 && !czy_zajety_bufor
  48:zapiseeprom.c **** 		return;
  49:zapiseeprom.c **** 	uchar pom = nr_zapisanego_znaku;
  50:zapiseeprom.c **** 	EECR |= BIT(EERE);
  51:zapiseeprom.c **** 	if ( EEDR == bufor_eeprom[pom] )	// sprawdzenie, czy zapisa- prawid-owo
  52:zapiseeprom.c **** 		++pom;
  53:zapiseeprom.c **** 
  54:zapiseeprom.c **** 	if ( pom < liczba_znakow_do_zapisu )
  55:zapiseeprom.c **** 	{
  56:zapiseeprom.c **** 		const uint poz = pozycja_w_eeprom + pom;
  57:zapiseeprom.c **** 		EEPROM_WRITE_ATMEGA8(poz, bufor_eeprom[pom]);
  58:zapiseeprom.c **** 	}
  59:zapiseeprom.c **** 	else
  60:zapiseeprom.c **** 	{
  61:zapiseeprom.c **** 		const uchar k = bufor_pomoc_liczba_znakow_do_zapisu;
  62:zapiseeprom.c **** 		bufor_pomoc_liczba_znakow_do_zapisu = 0;
  63:zapiseeprom.c **** 		liczba_znakow_do_zapisu = k;
  64:zapiseeprom.c **** 		if ( k != 0 )
  65:zapiseeprom.c **** 		{
  66:zapiseeprom.c **** 			for (uchar i = 0; i < k; ++i)
  67:zapiseeprom.c **** 				bufor_eeprom[i] = bufor_eeprom[POLOZENIE_BUFOR_EEPROM_POMOC_BUFOR_START+i];
  68:zapiseeprom.c **** 			pozycja_w_eeprom = bufor_pomoc_adres_eeprom;
  69:zapiseeprom.c **** 			pom = 0;
  70:zapiseeprom.c **** 			EEPROM_WRITE_ATMEGA8(pozycja_w_eeprom, bufor_eeprom[0]);
  71:zapiseeprom.c **** 		}
  72:zapiseeprom.c **** 		else
  73:zapiseeprom.c **** 		{
  74:zapiseeprom.c **** 			EEARH = 0x0f;
  75:zapiseeprom.c **** 			EEARL = 0xff;
  76:zapiseeprom.c **** 		}
  77:zapiseeprom.c **** 	}
  78:zapiseeprom.c **** 	nr_zapisanego_znaku = pom;
  79:zapiseeprom.c **** }
  80:zapiseeprom.c **** 
  81:zapiseeprom.c **** 	// uwaga, w-¦cza przerwania sei()
  82:zapiseeprom.c **** void zapisz_znaki_w_eeprom(const void* buf, const uint pozycja_w_eeprom_, 
  83:zapiseeprom.c **** 	const uchar liczba_znakow)
  84:zapiseeprom.c **** {
  85:zapiseeprom.c **** 	// wczeniej sprawdzono, czy mo¬na zapisywaŠ
  86:zapiseeprom.c **** 	if ( liczba_znakow == 0 )
  87:zapiseeprom.c **** 		return;
  88:zapiseeprom.c **** 	memcpy(bufor_eeprom, buf, liczba_znakow);
  89:zapiseeprom.c **** 	pozycja_w_eeprom = pozycja_w_eeprom_;
  90:zapiseeprom.c **** 	nr_zapisanego_znaku = 0;
  91:zapiseeprom.c **** 	liczba_znakow_do_zapisu = liczba_znakow;
  92:zapiseeprom.c **** 	EEPROM_WRITE_ATMEGA8(pozycja_w_eeprom_, bufor_eeprom[0]);
  93:zapiseeprom.c **** }
  94:zapiseeprom.c **** 
  95:zapiseeprom.c **** void zapisz_znaki_w_eeprom_bez_kopiowania(const uint pozycja_w_eeprom_, 
  15               		.loc 1 95 0
  16               		.cfi_startproc
  17               	.LVL0:
  18               	/* prologue: function */
  19               	/* frame size = 0 */
  20               	/* stack size = 0 */
  21               	.L__stack_usage = 0
  96:zapiseeprom.c **** 	const uchar liczba_znakow)
  97:zapiseeprom.c **** {
  98:zapiseeprom.c **** 	// wczeniej sprawdzono, czy mo¬na zapisywaŠ
  99:zapiseeprom.c **** 	if ( liczba_znakow == 0 )
 100:zapiseeprom.c **** 		return;
 101:zapiseeprom.c **** 	pozycja_w_eeprom = pozycja_w_eeprom_;
  22               		.loc 1 101 0
  23 0000 8093 0000 		sts pozycja_w_eeprom,r24
  24 0004 9093 0000 		sts pozycja_w_eeprom+1,r25
 102:zapiseeprom.c **** 	nr_zapisanego_znaku = 0;
  25               		.loc 1 102 0
  26 0008 1092 0000 		sts nr_zapisanego_znaku,__zero_reg__
 103:zapiseeprom.c **** 	liczba_znakow_do_zapisu = liczba_znakow;
  27               		.loc 1 103 0
  28 000c 6093 0000 		sts liczba_znakow_do_zapisu,r22
  29               	.LVL1:
  30               	.LBB5:
 104:zapiseeprom.c **** 	EEPROM_WRITE_ATMEGA8(pozycja_w_eeprom_, bufor_eeprom[0]);
  31               		.loc 1 104 0
  32 0010 92BD      		out 0x22,r25
  33 0012 81BD      		out 0x21,r24
  34 0014 F89A      		sbi 0x1f,0
  35 0016 90B5      		in r25,0x20
  36               	.LVL2:
  37 0018 8091 0000 		lds r24,bufor_eeprom
  38               	.LVL3:
  39 001c 9817      		cp r25,r24
  40 001e 01F0      		breq .L1
  41 0020 80BD      		out 0x20,r24
  42               	.LVL4:
  43               	/* #APP */
  44               	 ;  104 "zapiseeprom.c" 1
  45 0022 F894      		cli
  46               	 ;  0 "" 2
  47               	/* #NOAPP */
  48 0024 FA9A      		sbi 0x1f,2
  49 0026 F99A      		sbi 0x1f,1
  50               	/* #APP */
  51               	 ;  104 "zapiseeprom.c" 1
  52 0028 7894      		sei
  53               	 ;  0 "" 2
  54               	/* #NOAPP */
  55               	.L1:
  56               	/* epilogue start */
  57               	.LBE5:
 105:zapiseeprom.c **** }
  58               		.loc 1 105 0
  59 002a 0895      		ret
  60               		.cfi_endproc
  61               	.LFE9:
  63               	.global	zapisz_bajt_w_EEPROM
  65               	zapisz_bajt_w_EEPROM:
  66               	.LFB4:
  45:zapiseeprom.c **** 	if ( !eeprom_is_ready() 
  67               		.loc 1 45 0
  68               		.cfi_startproc
  69               	/* prologue: function */
  70               	/* frame size = 0 */
  71               	/* stack size = 0 */
  72               	.L__stack_usage = 0
  46:zapiseeprom.c **** 		|| (bufor_pomoc_liczba_znakow_do_zapisu == 0 && liczba_znakow_do_zapisu == 0 && !czy_zajety_bufor
  73               		.loc 1 46 0
  74 002c F999      		sbic 0x1f,1
  75 002e 00C0      		rjmp .L3
  47:zapiseeprom.c **** 		return;
  76               		.loc 1 47 0
  77 0030 8091 0000 		lds r24,bufor_pomoc_liczba_znakow_do_zapisu
  78 0034 8111      		cpse r24,__zero_reg__
  79 0036 00C0      		rjmp .L5
  47:zapiseeprom.c **** 		return;
  80               		.loc 1 47 0 is_stmt 0 discriminator 1
  81 0038 8091 0000 		lds r24,liczba_znakow_do_zapisu
  82 003c 8111      		cpse r24,__zero_reg__
  83 003e 00C0      		rjmp .L5
  47:zapiseeprom.c **** 		return;
  84               		.loc 1 47 0 discriminator 2
  85 0040 8091 0000 		lds r24,czy_zajety_bufor_eeprom
  86 0044 8823      		tst r24
  87 0046 01F0      		breq .L3
  88               	.L5:
  49:zapiseeprom.c **** 	EECR |= BIT(EERE);
  89               		.loc 1 49 0 is_stmt 1
  90 0048 8091 0000 		lds r24,nr_zapisanego_znaku
  91               	.LVL5:
  50:zapiseeprom.c **** 	if ( EEDR == bufor_eeprom[pom] )	// sprawdzenie, czy zapisa- prawid-owo
  92               		.loc 1 50 0
  93 004c F89A      		sbi 0x1f,0
  51:zapiseeprom.c **** 		++pom;
  94               		.loc 1 51 0
  95 004e 20B5      		in r18,0x20
  96 0050 E82F      		mov r30,r24
  97 0052 F0E0      		ldi r31,0
  98 0054 E050      		subi r30,lo8(-(bufor_eeprom))
  99 0056 F040      		sbci r31,hi8(-(bufor_eeprom))
 100 0058 9081      		ld r25,Z
 101 005a 2913      		cpse r18,r25
 102 005c 00C0      		rjmp .L6
  52:zapiseeprom.c **** 
 103               		.loc 1 52 0
 104 005e 8F5F      		subi r24,lo8(-(1))
 105               	.LVL6:
 106               	.L6:
  54:zapiseeprom.c **** 	{
 107               		.loc 1 54 0
 108 0060 9091 0000 		lds r25,liczba_znakow_do_zapisu
 109 0064 8917      		cp r24,r25
 110 0066 00F4      		brsh .L7
 111               	.LBB6:
  56:zapiseeprom.c **** 		EEPROM_WRITE_ATMEGA8(poz, bufor_eeprom[pom]);
 112               		.loc 1 56 0
 113 0068 282F      		mov r18,r24
 114 006a 30E0      		ldi r19,0
 115 006c 4091 0000 		lds r20,pozycja_w_eeprom
 116 0070 5091 0000 		lds r21,pozycja_w_eeprom+1
 117 0074 420F      		add r20,r18
 118 0076 531F      		adc r21,r19
 119               	.LVL7:
 120               	.LBB7:
  57:zapiseeprom.c **** 	}
 121               		.loc 1 57 0
 122 0078 52BD      		out 0x22,r21
 123 007a 41BD      		out 0x21,r20
 124 007c F89A      		sbi 0x1f,0
 125 007e 40B5      		in r20,0x20
 126               	.LVL8:
 127 0080 2050      		subi r18,lo8(-(bufor_eeprom))
 128 0082 3040      		sbci r19,hi8(-(bufor_eeprom))
 129 0084 F901      		movw r30,r18
 130 0086 9081      		ld r25,Z
 131 0088 4917      		cp r20,r25
 132 008a 01F0      		breq .L8
  57:zapiseeprom.c **** 	}
 133               		.loc 1 57 0 is_stmt 0 discriminator 1
 134 008c 90BD      		out 0x20,r25
 135               	/* #APP */
 136               	 ;  57 "zapiseeprom.c" 1
 137 008e F894      		cli
 138               	 ;  0 "" 2
 139               	/* #NOAPP */
 140 0090 FA9A      		sbi 0x1f,2
 141 0092 F99A      		sbi 0x1f,1
 142               	/* #APP */
 143               	 ;  57 "zapiseeprom.c" 1
 144 0094 7894      		sei
 145               	 ;  0 "" 2
 146               	.LVL9:
 147               	/* #NOAPP */
 148               	.L8:
 149               	.LBE7:
 150               	.LBE6:
  78:zapiseeprom.c **** }
 151               		.loc 1 78 0 is_stmt 1
 152 0096 8093 0000 		sts nr_zapisanego_znaku,r24
 153               	.LVL10:
 154               	.L3:
 155               	/* epilogue start */
  79:zapiseeprom.c **** 
 156               		.loc 1 79 0
 157 009a 0895      		ret
 158               	.LVL11:
 159               	.L7:
 160               	.LBB8:
  61:zapiseeprom.c **** 		bufor_pomoc_liczba_znakow_do_zapisu = 0;
 161               		.loc 1 61 0
 162 009c 9091 0000 		lds r25,bufor_pomoc_liczba_znakow_do_zapisu
 163               	.LVL12:
  62:zapiseeprom.c **** 		liczba_znakow_do_zapisu = k;
 164               		.loc 1 62 0
 165 00a0 1092 0000 		sts bufor_pomoc_liczba_znakow_do_zapisu,__zero_reg__
  63:zapiseeprom.c **** 		if ( k != 0 )
 166               		.loc 1 63 0
 167 00a4 9093 0000 		sts liczba_znakow_do_zapisu,r25
  64:zapiseeprom.c **** 		{
 168               		.loc 1 64 0
 169 00a8 9923      		tst r25
 170 00aa 01F0      		breq .L9
 171 00ac E0E0      		ldi r30,lo8(bufor_eeprom)
 172 00ae F0E0      		ldi r31,hi8(bufor_eeprom)
 173               	.LVL13:
 174               	.LBB9:
  66:zapiseeprom.c **** 				bufor_eeprom[i] = bufor_eeprom[POLOZENIE_BUFOR_EEPROM_POMOC_BUFOR_START+i];
 175               		.loc 1 66 0
 176 00b0 80E0      		ldi r24,0
 177               	.LVL14:
 178               	.L10:
  67:zapiseeprom.c **** 			pozycja_w_eeprom = bufor_pomoc_adres_eeprom;
 179               		.loc 1 67 0 discriminator 3
 180 00b2 20A5      		ldd r18,Z+40
 181 00b4 2193      		st Z+,r18
  66:zapiseeprom.c **** 				bufor_eeprom[i] = bufor_eeprom[POLOZENIE_BUFOR_EEPROM_POMOC_BUFOR_START+i];
 182               		.loc 1 66 0 discriminator 3
 183 00b6 8F5F      		subi r24,lo8(-(1))
 184               	.LVL15:
 185 00b8 9813      		cpse r25,r24
 186 00ba 00C0      		rjmp .L10
 187               	.LBE9:
  68:zapiseeprom.c **** 			pom = 0;
 188               		.loc 1 68 0
 189 00bc 8091 0000 		lds r24,bufor_pomoc_adres_eeprom
 190               	.LVL16:
 191 00c0 9091 0000 		lds r25,bufor_pomoc_adres_eeprom+1
 192               	.LVL17:
 193 00c4 8093 0000 		sts pozycja_w_eeprom,r24
 194 00c8 9093 0000 		sts pozycja_w_eeprom+1,r25
 195               	.LVL18:
 196               	.LBB10:
  70:zapiseeprom.c **** 		}
 197               		.loc 1 70 0
 198 00cc 92BD      		out 0x22,r25
 199               	.LVL19:
 200 00ce 81BD      		out 0x21,r24
 201 00d0 F89A      		sbi 0x1f,0
 202 00d2 90B5      		in r25,0x20
 203               	.LVL20:
 204 00d4 8091 0000 		lds r24,bufor_eeprom
 205               	.LVL21:
 206 00d8 9817      		cp r25,r24
 207 00da 01F0      		breq .L11
  70:zapiseeprom.c **** 		}
 208               		.loc 1 70 0 is_stmt 0 discriminator 1
 209 00dc 80BD      		out 0x20,r24
 210               	.LVL22:
 211               	/* #APP */
 212               	 ;  70 "zapiseeprom.c" 1
 213 00de F894      		cli
 214               	 ;  0 "" 2
 215               	/* #NOAPP */
 216 00e0 FA9A      		sbi 0x1f,2
 217 00e2 F99A      		sbi 0x1f,1
 218               	/* #APP */
 219               	 ;  70 "zapiseeprom.c" 1
 220 00e4 7894      		sei
 221               	 ;  0 "" 2
 222               	/* #NOAPP */
 223               	.L11:
 224               	.LBE10:
  69:zapiseeprom.c **** 			EEPROM_WRITE_ATMEGA8(pozycja_w_eeprom, bufor_eeprom[0]);
 225               		.loc 1 69 0 is_stmt 1
 226 00e6 80E0      		ldi r24,0
 227 00e8 00C0      		rjmp .L8
 228               	.LVL23:
 229               	.L9:
  74:zapiseeprom.c **** 			EEARL = 0xff;
 230               		.loc 1 74 0
 231 00ea 9FE0      		ldi r25,lo8(15)
 232               	.LVL24:
 233 00ec 92BD      		out 0x22,r25
 234               	.LVL25:
  75:zapiseeprom.c **** 		}
 235               		.loc 1 75 0
 236 00ee 9FEF      		ldi r25,lo8(-1)
 237 00f0 91BD      		out 0x21,r25
 238 00f2 00C0      		rjmp .L8
 239               	.LBE8:
 240               		.cfi_endproc
 241               	.LFE4:
 243               	.global	zapisz_znaki_w_eeprom
 245               	zapisz_znaki_w_eeprom:
 246               	.LFB5:
  84:zapiseeprom.c **** 	// wczeniej sprawdzono, czy mo¬na zapisywaŠ
 247               		.loc 1 84 0
 248               		.cfi_startproc
 249               	.LVL26:
 250 00f4 1F93      		push r17
 251               	.LCFI0:
 252               		.cfi_def_cfa_offset 3
 253               		.cfi_offset 17, -2
 254 00f6 CF93      		push r28
 255               	.LCFI1:
 256               		.cfi_def_cfa_offset 4
 257               		.cfi_offset 28, -3
 258 00f8 DF93      		push r29
 259               	.LCFI2:
 260               		.cfi_def_cfa_offset 5
 261               		.cfi_offset 29, -4
 262               	/* prologue: function */
 263               	/* frame size = 0 */
 264               	/* stack size = 3 */
 265               	.L__stack_usage = 3
  86:zapiseeprom.c **** 		return;
 266               		.loc 1 86 0
 267 00fa 4423      		tst r20
 268 00fc 01F0      		breq .L16
 269 00fe C42F      		mov r28,r20
 270 0100 172F      		mov r17,r23
 271 0102 D62F      		mov r29,r22
 272 0104 BC01      		movw r22,r24
 273               	.LVL27:
  88:zapiseeprom.c **** 	pozycja_w_eeprom = pozycja_w_eeprom_;
 274               		.loc 1 88 0
 275 0106 50E0      		ldi r21,0
 276 0108 80E0      		ldi r24,lo8(bufor_eeprom)
 277 010a 90E0      		ldi r25,hi8(bufor_eeprom)
 278               	.LVL28:
 279 010c 0E94 0000 		call memcpy
 280               	.LVL29:
  89:zapiseeprom.c **** 	nr_zapisanego_znaku = 0;
 281               		.loc 1 89 0
 282 0110 D093 0000 		sts pozycja_w_eeprom,r29
 283 0114 1093 0000 		sts pozycja_w_eeprom+1,r17
  90:zapiseeprom.c **** 	liczba_znakow_do_zapisu = liczba_znakow;
 284               		.loc 1 90 0
 285 0118 1092 0000 		sts nr_zapisanego_znaku,__zero_reg__
  91:zapiseeprom.c **** 	EEPROM_WRITE_ATMEGA8(pozycja_w_eeprom_, bufor_eeprom[0]);
 286               		.loc 1 91 0
 287 011c C093 0000 		sts liczba_znakow_do_zapisu,r28
 288               	.LVL30:
 289               	.LBB11:
  92:zapiseeprom.c **** }
 290               		.loc 1 92 0
 291 0120 12BD      		out 0x22,r17
 292 0122 D1BD      		out 0x21,r29
 293 0124 F89A      		sbi 0x1f,0
 294 0126 90B5      		in r25,0x20
 295 0128 8091 0000 		lds r24,bufor_eeprom
 296 012c 9817      		cp r25,r24
 297 012e 01F0      		breq .L16
  92:zapiseeprom.c **** }
 298               		.loc 1 92 0 is_stmt 0 discriminator 1
 299 0130 80BD      		out 0x20,r24
 300               	/* #APP */
 301               	 ;  92 "zapiseeprom.c" 1
 302 0132 F894      		cli
 303               	 ;  0 "" 2
 304               	/* #NOAPP */
 305 0134 FA9A      		sbi 0x1f,2
 306 0136 F99A      		sbi 0x1f,1
 307               	/* #APP */
 308               	 ;  92 "zapiseeprom.c" 1
 309 0138 7894      		sei
 310               	 ;  0 "" 2
 311               	.LVL31:
 312               	/* #NOAPP */
 313               	.L16:
 314               	/* epilogue start */
 315               	.LBE11:
  93:zapiseeprom.c **** 
 316               		.loc 1 93 0 is_stmt 1
 317 013a DF91      		pop r29
 318 013c CF91      		pop r28
 319 013e 1F91      		pop r17
 320 0140 0895      		ret
 321               		.cfi_endproc
 322               	.LFE5:
 324               	.global	zapisz_znaki_w_eeprom_bez_kopiowania
 326               	zapisz_znaki_w_eeprom_bez_kopiowania:
 327               	.LFB6:
  97:zapiseeprom.c **** 	// wczeniej sprawdzono, czy mo¬na zapisywaŠ
 328               		.loc 1 97 0
 329               		.cfi_startproc
 330               	.LVL32:
 331               	/* prologue: function */
 332               	/* frame size = 0 */
 333               	/* stack size = 0 */
 334               	.L__stack_usage = 0
  99:zapiseeprom.c **** 		return;
 335               		.loc 1 99 0
 336 0142 6111      		cpse r22,__zero_reg__
 337 0144 0C94 0000 		jmp zapisz_znaki_w_eeprom_bez_kopiowania.part.0
 338               	.LVL33:
 339               	.L20:
 340               	/* epilogue start */
 341               		.loc 1 105 0
 342 0148 0895      		ret
 343               		.cfi_endproc
 344               	.LFE6:
 346               	.global	zapisz_znak_w_eeprom
 348               	zapisz_znak_w_eeprom:
 349               	.LFB7:
 106:zapiseeprom.c **** 
 107:zapiseeprom.c **** 	// uwaga, w-¦cza przerwania sei()
 108:zapiseeprom.c **** void zapisz_znak_w_eeprom(const uchar znak, const uint pozycja_w_eeprom_)
 109:zapiseeprom.c **** {
 350               		.loc 1 109 0
 351               		.cfi_startproc
 352               	.LVL34:
 353 014a 1F93      		push r17
 354               	.LCFI3:
 355               		.cfi_def_cfa_offset 3
 356               		.cfi_offset 17, -2
 357 014c CF93      		push r28
 358               	.LCFI4:
 359               		.cfi_def_cfa_offset 4
 360               		.cfi_offset 28, -3
 361 014e DF93      		push r29
 362               	.LCFI5:
 363               		.cfi_def_cfa_offset 5
 364               		.cfi_offset 29, -4
 365               	/* prologue: function */
 366               	/* frame size = 0 */
 367               	/* stack size = 3 */
 368               	.L__stack_usage = 3
 369 0150 182F      		mov r17,r24
 370 0152 EB01      		movw r28,r22
 110:zapiseeprom.c **** 	// wczeniej sprawdzono, czy mo¬na zapisywaŠ
 111:zapiseeprom.c **** 	if ( eeprom_read_byte((void*) pozycja_w_eeprom_) == znak )
 371               		.loc 1 111 0
 372 0154 CB01      		movw r24,r22
 373               	.LVL35:
 374 0156 0E94 0000 		call eeprom_read_byte
 375               	.LVL36:
 376 015a 8117      		cp r24,r17
 377 015c 01F0      		breq .L22
 112:zapiseeprom.c **** 		return;
 113:zapiseeprom.c **** 	bufor_eeprom[0] = znak;
 378               		.loc 1 113 0
 379 015e 1093 0000 		sts bufor_eeprom,r17
 380               	.LVL37:
 381               	.LBB12:
 382               	.LBB13:
 383 0162 61E0      		ldi r22,lo8(1)
 384 0164 CE01      		movw r24,r28
 385               	/* epilogue start */
 386               	.LBE13:
 387               	.LBE12:
 114:zapiseeprom.c **** 	zapisz_znaki_w_eeprom_bez_kopiowania(pozycja_w_eeprom_, 1);
 115:zapiseeprom.c **** }
 388               		.loc 1 115 0
 389 0166 DF91      		pop r29
 390 0168 CF91      		pop r28
 391               	.LVL38:
 392 016a 1F91      		pop r17
 393               	.LVL39:
 394               	.LBB15:
 395               	.LBB14:
 396 016c 0C94 0000 		jmp zapisz_znaki_w_eeprom_bez_kopiowania.part.0
 397               	.LVL40:
 398               	.L22:
 399               	/* epilogue start */
 400               	.LBE14:
 401               	.LBE15:
 402 0170 DF91      		pop r29
 403 0172 CF91      		pop r28
 404               	.LVL41:
 405 0174 1F91      		pop r17
 406               	.LVL42:
 407 0176 0895      		ret
 408               		.cfi_endproc
 409               	.LFE7:
 411               	.global	eeprom_read_3char
 413               	eeprom_read_3char:
 414               	.LFB8:
 116:zapiseeprom.c **** 
 117:zapiseeprom.c **** //int memcmp_E(const void* buf, const void* eeprom_ptr, size_t size)
 118:zapiseeprom.c **** //{
 119:zapiseeprom.c **** //	if ( size == 0 )
 120:zapiseeprom.c **** //		return 0;
 121:zapiseeprom.c **** //	while ( *(uchar*) buf == eeprom_read_byte(eeprom_ptr) && --size )
 122:zapiseeprom.c **** //	{
 123:zapiseeprom.c **** //		++buf;
 124:zapiseeprom.c **** //		++eeprom_ptr;
 125:zapiseeprom.c **** //	}
 126:zapiseeprom.c **** //	return *(uchar*)buf - eeprom_read_byte(eeprom_ptr);
 127:zapiseeprom.c **** //}
 128:zapiseeprom.c **** 
 129:zapiseeprom.c **** //void* memchr_E(void* eeprom_ptr, const char ch, size_t size)
 130:zapiseeprom.c **** //{
 131:zapiseeprom.c **** //	if ( size == 0 )
 132:zapiseeprom.c **** //		return 0;
 133:zapiseeprom.c **** //	while ( ch != eeprom_read_byte(eeprom_ptr) && --size )
 134:zapiseeprom.c **** //	{
 135:zapiseeprom.c **** //		++eeprom_ptr;
 136:zapiseeprom.c **** //	}
 137:zapiseeprom.c **** //	return ch != eeprom_read_byte(eeprom_ptr) ? NULL : eeprom_ptr;
 138:zapiseeprom.c **** //}
 139:zapiseeprom.c **** //
 140:zapiseeprom.c **** //int strncpy_E(const void* buf, const void* eeprom_ptr, size_t size)
 141:zapiseeprom.c **** //{
 142:zapiseeprom.c **** //	const void* buf_beg = buf;
 143:zapiseeprom.c **** //	while ( size-- && (*(uchar*) buf = eeprom_read_byte(eeprom_ptr)) != 0 )
 144:zapiseeprom.c **** //	{
 145:zapiseeprom.c **** //		++buf;
 146:zapiseeprom.c **** //		++eeprom_ptr;
 147:zapiseeprom.c **** //	}
 148:zapiseeprom.c **** //	return buf - buf_beg;
 149:zapiseeprom.c **** //}
 150:zapiseeprom.c **** 
 151:zapiseeprom.c **** //int strncmp_E(const void* buf, const void* eeprom_ptr, size_t size)
 152:zapiseeprom.c **** //{
 153:zapiseeprom.c **** //	if ( size == 0 )
 154:zapiseeprom.c **** //		return 0;
 155:zapiseeprom.c **** //	while ( (*(uchar*) buf == eeprom_read_byte(eeprom_ptr)) && --size )
 156:zapiseeprom.c **** //	{
 157:zapiseeprom.c **** //		if ( *(uchar*) buf == 0 )
 158:zapiseeprom.c **** //			break;
 159:zapiseeprom.c **** //		++buf;
 160:zapiseeprom.c **** //		++eeprom_ptr;
 161:zapiseeprom.c **** //	}
 162:zapiseeprom.c **** //	return *(uchar*)buf - eeprom_read_byte(eeprom_ptr);
 163:zapiseeprom.c **** //}
 164:zapiseeprom.c **** 
 165:zapiseeprom.c **** //int strncmp_any_char_E(const void* buf, const void* eeprom_ptr, size_t size)
 166:zapiseeprom.c **** //{
 167:zapiseeprom.c **** //	if ( size == 0 )
 168:zapiseeprom.c **** //		return 0;
 169:zapiseeprom.c **** //	while ( (toupper(*(uchar*) buf) == toupper(eeprom_read_byte(eeprom_ptr))) && --size )
 170:zapiseeprom.c **** //	{
 171:zapiseeprom.c **** //		if ( *(uchar*) buf == 0 )
 172:zapiseeprom.c **** //			break;
 173:zapiseeprom.c **** //		++buf;
 174:zapiseeprom.c **** //		++eeprom_ptr;
 175:zapiseeprom.c **** //	}
 176:zapiseeprom.c **** //	return *(uchar*)buf - eeprom_read_byte(eeprom_ptr);
 177:zapiseeprom.c **** //}
 178:zapiseeprom.c **** 
 179:zapiseeprom.c **** //int strnlen_E(const void* eeprom_ptr, size_t size)
 180:zapiseeprom.c **** //{
 181:zapiseeprom.c **** //	int i = 0;
 182:zapiseeprom.c **** //	while ( eeprom_read_byte(eeprom_ptr++) != 0 && size-- )
 183:zapiseeprom.c **** //		++i;
 184:zapiseeprom.c **** //	return i;
 185:zapiseeprom.c **** //}
 186:zapiseeprom.c **** 
 187:zapiseeprom.c **** //uint32_t eeprom_read_long(const uint32_t *addr)
 188:zapiseeprom.c **** //{
 189:zapiseeprom.c **** //	ulong l;
 190:zapiseeprom.c **** //	const uchar* ptr = (uchar*) addr;
 191:zapiseeprom.c **** //	uchar* ptr2 = (uchar*) &l;
 192:zapiseeprom.c **** //	*ptr2++ = eeprom_read_byte(ptr++);
 193:zapiseeprom.c **** //	*ptr2++ = eeprom_read_byte(ptr++);
 194:zapiseeprom.c **** //	*ptr2++ = eeprom_read_byte(ptr++);
 195:zapiseeprom.c **** //	*ptr2++ = eeprom_read_byte(ptr++);
 196:zapiseeprom.c **** //	return l;
 197:zapiseeprom.c **** //}
 198:zapiseeprom.c **** 
 199:zapiseeprom.c **** uint32_t eeprom_read_3char(const uint32_t *addr)
 200:zapiseeprom.c **** {
 415               		.loc 1 200 0
 416               		.cfi_startproc
 417               	.LVL43:
 418 0178 0F93      		push r16
 419               	.LCFI6:
 420               		.cfi_def_cfa_offset 3
 421               		.cfi_offset 16, -2
 422 017a 1F93      		push r17
 423               	.LCFI7:
 424               		.cfi_def_cfa_offset 4
 425               		.cfi_offset 17, -3
 426 017c CF93      		push r28
 427               	.LCFI8:
 428               		.cfi_def_cfa_offset 5
 429               		.cfi_offset 28, -4
 430 017e DF93      		push r29
 431               	.LCFI9:
 432               		.cfi_def_cfa_offset 6
 433               		.cfi_offset 29, -5
 434 0180 00D0      		rcall .
 435 0182 00D0      		rcall .
 436               	.LCFI10:
 437               		.cfi_def_cfa_offset 10
 438 0184 CDB7      		in r28,__SP_L__
 439 0186 DEB7      		in r29,__SP_H__
 440               	.LCFI11:
 441               		.cfi_def_cfa_register 28
 442               	/* prologue: function */
 443               	/* frame size = 4 */
 444               	/* stack size = 8 */
 445               	.L__stack_usage = 8
 446 0188 8C01      		movw r16,r24
 201:zapiseeprom.c **** 	ulong l = 0;
 447               		.loc 1 201 0
 448 018a 1982      		std Y+1,__zero_reg__
 449 018c 1A82      		std Y+2,__zero_reg__
 450 018e 1B82      		std Y+3,__zero_reg__
 451 0190 1C82      		std Y+4,__zero_reg__
 452               	.LVL44:
 202:zapiseeprom.c **** 	const uchar* ptr = (uchar*) addr;
 203:zapiseeprom.c **** 	uchar* ptr2 = (uchar*) &l;
 204:zapiseeprom.c **** 	*ptr2++ = eeprom_read_byte(ptr++);
 453               		.loc 1 204 0
 454 0192 0E94 0000 		call eeprom_read_byte
 455               	.LVL45:
 456 0196 8983      		std Y+1,r24
 457               	.LVL46:
 205:zapiseeprom.c **** 	*ptr2++ = eeprom_read_byte(ptr++);
 458               		.loc 1 205 0
 459 0198 C801      		movw r24,r16
 460 019a 0196      		adiw r24,1
 461 019c 0E94 0000 		call eeprom_read_byte
 462               	.LVL47:
 463 01a0 8A83      		std Y+2,r24
 464               	.LVL48:
 206:zapiseeprom.c **** 	*ptr2++ = eeprom_read_byte(ptr++);
 465               		.loc 1 206 0
 466 01a2 C801      		movw r24,r16
 467 01a4 0296      		adiw r24,2
 468 01a6 0E94 0000 		call eeprom_read_byte
 469               	.LVL49:
 470 01aa 8B83      		std Y+3,r24
 207:zapiseeprom.c **** 	return l;
 471               		.loc 1 207 0
 472 01ac 6981      		ldd r22,Y+1
 473 01ae 7A81      		ldd r23,Y+2
 474 01b0 8B81      		ldd r24,Y+3
 475 01b2 9C81      		ldd r25,Y+4
 476               	/* epilogue start */
 208:zapiseeprom.c **** }
 477               		.loc 1 208 0
 478 01b4 0F90      		pop __tmp_reg__
 479 01b6 0F90      		pop __tmp_reg__
 480 01b8 0F90      		pop __tmp_reg__
 481 01ba 0F90      		pop __tmp_reg__
 482 01bc DF91      		pop r29
 483 01be CF91      		pop r28
 484               	.LVL50:
 485 01c0 1F91      		pop r17
 486               	.LVL51:
 487 01c2 0F91      		pop r16
 488               	.LVL52:
 489 01c4 0895      		ret
 490               		.cfi_endproc
 491               	.LFE8:
 493               		.comm	czy_zajety_bufor_eeprom,1,1
 494               		.comm	bufor_pomoc_adres_eeprom,2,1
 495               		.comm	bufor_pomoc_liczba_znakow_do_zapisu,1,1
 496               		.comm	pozycja_w_eeprom,2,1
 497               	.global	nr_zapisanego_znaku
 498               		.section .bss
 501               	nr_zapisanego_znaku:
 502 0000 00        		.zero	1
 503               	.global	liczba_znakow_do_zapisu
 506               	liczba_znakow_do_zapisu:
 507 0001 00        		.zero	1
 508               		.comm	bufor_eeprom,50,1
 509               		.text
 510               	.Letext0:
 511               		.file 2 "narzedzia.h"
 512               		.file 3 "/usr/local/avr8-gnu-toolchain/lib/gcc/avr/7.3.0/include/stddef.h"
 513               		.file 4 "/usr/local/avr8-gnu-toolchain/avr/include/stdlib.h"
 514               		.file 5 "zapiseeprom.h"
 515               		.file 6 "/usr/local/avr8-gnu-toolchain/avr/include/stdint.h"
 516               		.file 7 "/usr/local/avr8-gnu-toolchain/avr/include/avr/eeprom.h"
 517               		.file 8 "<built-in>"
DEFINED SYMBOLS
                            *ABS*:0000000000000000 zapiseeprom.c
/var/folders/6z/r258d_ld7nl6hm6r8km5x35c0000gn/T//ccD5lMwB.s:2      *ABS*:000000000000003e __SP_H__
/var/folders/6z/r258d_ld7nl6hm6r8km5x35c0000gn/T//ccD5lMwB.s:3      *ABS*:000000000000003d __SP_L__
/var/folders/6z/r258d_ld7nl6hm6r8km5x35c0000gn/T//ccD5lMwB.s:4      *ABS*:000000000000003f __SREG__
/var/folders/6z/r258d_ld7nl6hm6r8km5x35c0000gn/T//ccD5lMwB.s:5      *ABS*:000000000000003b __RAMPZ__
/var/folders/6z/r258d_ld7nl6hm6r8km5x35c0000gn/T//ccD5lMwB.s:6      *ABS*:0000000000000000 __tmp_reg__
/var/folders/6z/r258d_ld7nl6hm6r8km5x35c0000gn/T//ccD5lMwB.s:7      *ABS*:0000000000000001 __zero_reg__
/var/folders/6z/r258d_ld7nl6hm6r8km5x35c0000gn/T//ccD5lMwB.s:12     .text:0000000000000000 zapisz_znaki_w_eeprom_bez_kopiowania.part.0
                            *COM*:0000000000000002 pozycja_w_eeprom
/var/folders/6z/r258d_ld7nl6hm6r8km5x35c0000gn/T//ccD5lMwB.s:501    .bss:0000000000000000 nr_zapisanego_znaku
/var/folders/6z/r258d_ld7nl6hm6r8km5x35c0000gn/T//ccD5lMwB.s:506    .bss:0000000000000001 liczba_znakow_do_zapisu
                            *COM*:0000000000000032 bufor_eeprom
/var/folders/6z/r258d_ld7nl6hm6r8km5x35c0000gn/T//ccD5lMwB.s:65     .text:000000000000002c zapisz_bajt_w_EEPROM
                            *COM*:0000000000000001 bufor_pomoc_liczba_znakow_do_zapisu
                            *COM*:0000000000000001 czy_zajety_bufor_eeprom
                            *COM*:0000000000000002 bufor_pomoc_adres_eeprom
/var/folders/6z/r258d_ld7nl6hm6r8km5x35c0000gn/T//ccD5lMwB.s:245    .text:00000000000000f4 zapisz_znaki_w_eeprom
/var/folders/6z/r258d_ld7nl6hm6r8km5x35c0000gn/T//ccD5lMwB.s:326    .text:0000000000000142 zapisz_znaki_w_eeprom_bez_kopiowania
/var/folders/6z/r258d_ld7nl6hm6r8km5x35c0000gn/T//ccD5lMwB.s:348    .text:000000000000014a zapisz_znak_w_eeprom
/var/folders/6z/r258d_ld7nl6hm6r8km5x35c0000gn/T//ccD5lMwB.s:413    .text:0000000000000178 eeprom_read_3char

UNDEFINED SYMBOLS
memcpy
eeprom_read_byte
__do_clear_bss
